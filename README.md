# ERA Padel League — турнирные таблицы сезона

Одностраничный сайт для публикации прогресса сезона ERA Padel League: турнирные таблицы по вкладкам Gold, Silver, Ladies, Mix, история матчей и автоматический пересчёт очков/рейтинга.

## Как запустить локально

1. Откройте `index.html` напрямую в браузере **или** поднимите любой статический сервер:
   ```bash
   python -m http.server
   ```
2. Перейдите по адресу из консоли (по умолчанию `http://localhost:8000`).

## Структура проекта

- `index.html` — каркас страницы и контейнеры для динамического контента.
- `styles/main.css` — оформление и адаптивные стили.
- `scripts/main.js` — загрузка данных, расчёт таблиц, рендер истории матчей.
- `scripts/manage_matches.py` — утилита для пересборки, обновления и создания матчей.
- `data/season.yml` — метаданные сезона (название, подпись, штамп обновления, примечания).
- `data/rules.yml` — очки, рейтинговые коэффициенты и критерии тай-брейка.
- `data/divisions/<id>/division.yml` — описание дивизиона и ссылки на файлы групп.
- `data/divisions/<id>/groups/*.yml` — команды и матчи конкретной группы.
- `data/divisions.json` — агрегированный JSON для клиента, пересобирается из YAML скриптом `scripts/build_data.py`.
- `images/` — при желании можно хранить фото команд/клубов (необязательно для таблиц).

## Структура данных

Данные разбиты на несколько YAML-файлов, чтобы упрощать редактирование и исключить конфликт при совместной работе:

- `season.yml` — заголовок сезона, подпись, штамп обновления и примечание.
- `rules.yml` — очки за исходы, параметры рейтинга и список тай-брейков.
- `divisions/<id>/division.yml` — описание дивизиона и список файлов групп.
- `divisions/<id>/groups/*.yml` — команды и матчи конкретной группы.

### Пример `division.yml`

```yaml
id: gold
title: Gold
description: Команды уровня Gold, разделённые на когорты «Сияние» и «Импульс».
groups:
  - id: gold-01
    file: groups/siyanie.yml
  - id: gold-02
    file: groups/impuls.yml
```

### Пример файла группы

```yaml
id: gold-01
label: Подгруппа 1
teams:
  - id: Алексей Сорокин - Глеб Антонов
    name: Алексей Сорокин - Глеб Антонов
    players: [Алексей Сорокин, Глеб Антонов]
matches:
  - id: gold-01-006
    round: 3
    date: 2025-10-21
    home: Илья Романов - Сергей Белый
    away: Роман Щербаков - Дмитрий Литвиненко
    result:
      status: played
      winner: home
      sets:
        - { home: 5, away: 7 }
        - { home: 6, away: 4 }
        - { home: 7, away: 5 }
```

> Все дивизионы используют нумерацию подгрупп (`Подгруппа 1`, `Подгруппа 2` и т.д.), идентификаторы теперь выглядят как `gold-01`, `silver-02`, `ladies-01`.

### Полезные скрипты

- `python scripts/build_data.py` — собирает все YAML-файлы в `data/divisions.json`. Скрипт автоматически сортирует дивизионы в порядке Gold → Silver → Ladies → Mix.
- `python scripts/manage_matches.py` — быстрый способ пересобрать `data/divisions.json` из YAML без лишних флагов.
- `python scripts/manage_matches.py --interactive` — пошаговый режим: выбираете дивизион → группу, затем обновляете существующий матч или добавляете новый.
- `python scripts/manage_matches.py --create --division gold --group gold-02 --match gold-02-010 --home "Алексей" --away "Илья" --round 4 --status scheduled` — пример создания матча из терминала.
- `python scripts/manage_matches.py --division gold --group gold-01 --match gold-01-006 --status played --winner home --sets 6-4,3-6,7-5` — точечное обновление через аргументы командной строки (флаг `--no-build` сохраняет изменения без пересборки JSON).

В ручном режиме скрипт `manage_matches.py` принимает параметры `--date`, `--round`, `--reason`, `--clear-sets`, `--winner`, а для создания матчей — также `--home` и `--away`. Пустая строка в `--date` или `--reason` удаляет поле. Для технических результатов используйте `--status wo --winner home --reason "Техническая победа"`.

## Как обновлять турнир

1. Обновите `data/season.yml` (например, `updatedAt`) и/или соответствующий файл группы в `data/divisions/<id>/groups/`.
2. Для редактирования или планирования матчей можно воспользоваться утилитой `scripts/manage_matches.py`, либо внести изменения вручную в YAML.
3. Запустите `python scripts/manage_matches.py` (или `python scripts/build_data.py`), чтобы пересобрать `data/divisions.json`. Диалоговый режим и прямые аргументы пересобирают файл автоматически, если не передан `--no-build`.
4. Перезагрузите страницу — таблицы, очки, разница сетов и рейтинг пересчитаются автоматически.

> Названия команд по-прежнему формируются из имён и фамилий игроков, соединённых тире (`Имя Фамилия - Имя Фамилия`). Дополнительные поля (например, `club`, `note`) можно добавлять свободно — рендер поддерживает незнакомые поля.

## Развёртывание на GitHub Pages

1. Обновите репозиторий и залейте изменения в ветку, из которой публикуется GitHub Pages (`main` или `gh-pages`).
2. Проверьте, что опция GitHub Pages настроена на `index.html` в корне или в каталоге `docs/` (если используется другая схема, обновите пути).
3. После деплоя просто обновите страницу — новые результаты подтянутся автоматически.

## Подсказки по ведению сезона

- Для команд можно хранить дополнительные поля (`club`, `coach`, `social`) — они никак не ломают расчёты.
- Если хотите хранить заметки или видео по матчу, добавьте поля `note`, `links` в объект `result` — скрипт аккуратно покажет их под карточкой.
- При большом объёме данных удобно вести результаты в Google Sheets, а затем экспортировать участок в JSON (формат совпадает). Главное — оставить идентификаторы команд и матчей.

Если нужна автоматизация (например, скрипт для добавления результатов из CSV), добавьте задачу в TODO — каркас под расширение уже готов.
